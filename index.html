<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nextup Studio</title>
  <meta name="description" content="Nextup Studio is the official website of Vanshu Agarwal. Explore original music, Minecraft content, games, and more." />
  <link rel="stylesheet" href="style.css" />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <!-- Sun/Moon Theme Toggle Button, OUTSIDE all containers -->
  <button id="themeToggle" aria-label="Toggle theme" title="Toggle theme">🌙</button>
  <div class="layout">
    <nav class="sidebar" aria-label="Primary">
      <h2>Nextup Studio</h2>
      <a href="index.html" class="active" aria-current="page">Home</a>
      <a href="yt.html">YouTube</a>
      <a href="journey.html">My Journey</a>
      <a href="game.html">Game</a>
    </nav>
    <main class="main-content">
      <h1>👋 Welcome to Nextup Studio</h1>
      <p>This is the official site of <strong>Vanshu Agarwal</strong>. Here you’ll find:</p>
      <ul>
        <li>🎵 Original Songs</li>
        <li>🎮 Minecraft Shorts & Gameplay</li>
        <li>🧠 Mind Relax Game</li>
        <li>📈 My Life Journey and Milestones</li>
      </ul>
      <p>Stay connected with me through Instagram, YouTube, and WhatsApp!</p>

      <!-- Google Login Button -->
      <div class="google-login" id="googleLoginBtnContainer" aria-label="Google Sign-in Button"></div>

      <!-- Username prompt -->
      <div id="usernamePrompt" role="region" aria-live="polite" aria-atomic="true">
        <input type="text" id="usernameInput" placeholder="Choose a username" aria-label="Choose a username" />
        <button id="setUsernameBtn">Set Username</button>
      </div>

      <!-- Welcome user display -->
      <div id="welcomeUser" aria-live="polite" aria-atomic="true"></div>

      <!-- Logout button -->
      <div id="logoutContainer" aria-label="Logout Button Container"></div>

      <!-- Music play/pause controls -->
      <div id="musicControl" role="region" aria-label="Background music controls">
        <button id="playMusicBtn">▶ Play Music</button>
        <button id="pauseMusicBtn">◼ Pause Music</button>
      </div>

      <!-- Secret Vault Link -->
      <p class="secret-link">
        Some <a href="vault.html" aria-label="Open secret vault">secrets</a> are better left unspoken...
      </p>

      <!-- Social Buttons -->
      <div class="social-buttons" aria-label="Social media links">
        <a class="whatsapp" href="https://wa.me/919412104618" target="_blank" rel="noopener noreferrer" aria-label="Chat on WhatsApp">📱 Chat on WhatsApp</a>
        <a class="youtube" href="https://www.youtube.com/@nextupstudioyt" target="_blank" rel="noopener noreferrer" aria-label="Subscribe on YouTube">▶️ Subscribe on YouTube</a>
        <a class="instagram" href="https://www.instagram.com/vanshu_ag_72" target="_blank" rel="noopener noreferrer" aria-label="Follow on Instagram">📷 Follow on Instagram</a>
      </div>
    </main>
  </div>

  <!-- Background music -->
  <audio id="bgMusic" src="music/Music.mp3" loop></audio>

  <div class="popup" role="alert" aria-live="assertive">
    🔔 New! "Skyveil - The Echoes Beyond" <br />
    Watch it here: <a href="https://youtu.be/6-JN1GLXdgY?feature=shared" target="_blank" rel="noopener noreferrer">Click to Watch</a>
  </div>

  <script>
    const CLIENT_ID = "455141367100-f2jev8v887uer781j5ajg326375bud0h.apps.googleusercontent.com";

    const welcomeDiv = document.getElementById('welcomeUser');
    const usernamePrompt = document.getElementById('usernamePrompt');
    const usernameInput = document.getElementById('usernameInput');
    const setUsernameBtn = document.getElementById('setUsernameBtn');
    const loginContainer = document.getElementById('googleLoginBtnContainer');
    const logoutContainer = document.getElementById('logoutContainer');
    const bgMusic = document.getElementById('bgMusic');
    const playMusicBtn = document.getElementById('playMusicBtn');
    const pauseMusicBtn = document.getElementById('pauseMusicBtn');
    const themeToggle = document.getElementById('themeToggle');

    // Music control
    playMusicBtn.addEventListener('click', () => bgMusic.play());
    pauseMusicBtn.addEventListener('click', () => bgMusic.pause());

    // Load saved user
    let savedUser = JSON.parse(localStorage.getItem('nextupUser'));
    if(savedUser){
      welcomeDiv.textContent = `👋 Welcome, ${savedUser.username}!`;
      addLogoutButton();
    }

    // Google identity callback
    let tempUser = null;
    function handleCredentialResponse(response){
      const base64Url = response.credential.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const user = JSON.parse(atob(base64));

      tempUser = user;
      loginContainer.style.display = 'none';
      usernamePrompt.style.display = 'block';
    }

    window.onload = () => {
      // Theme load from localStorage
      const savedTheme = localStorage.getItem('nextupTheme');
      if(savedTheme === 'light'){
        document.body.classList.add('light');
        themeToggle.textContent = '☀️';
      } else {
        themeToggle.textContent = '🌙';
      }

      if(!savedUser){
        google.accounts.id.initialize({
          client_id: CLIENT_ID,
          callback: handleCredentialResponse
        });
        google.accounts.id.renderButton(
          loginContainer,
          { theme: "outline", size: "large", text: "signin_with", shape:"pill" }
        );
      }
    };

    // Username set
    setUsernameBtn.addEventListener('click', () => {
      const username = usernameInput.value.trim();
      if(!username){
        alert("Please enter a username!");
        return;
      }
      const finalUser = {
        googleId: tempUser.sub,
        email: tempUser.email,
        name: tempUser.name,
        username: username
      };
      localStorage.setItem('nextupUser', JSON.stringify(finalUser));
      welcomeDiv.textContent = `👋 Welcome, ${username}!`;
      usernamePrompt.style.display = 'none';
      addLogoutButton();
    });

    function addLogoutButton(){
      logoutContainer.innerHTML = `<button id="logoutBtn">Logout</button>`;
      document.getElementById('logoutBtn').addEventListener('click', () => {
        localStorage.removeItem('nextupUser');
        location.reload();
      });
    }

    // Theme toggle button click
    themeToggle.addEventListener('click', () => {
      if(document.body.classList.contains('light')){
        document.body.classList.remove('light');
        themeToggle.textContent = '🌙';
        localStorage.setItem('nextupTheme', 'dark');
      } else {
        document.body.classList.add('light');
        themeToggle.textContent = '☀️';
        localStorage.setItem('nextupTheme', 'light');
      }
    });
  </script>
</body>
</html>
